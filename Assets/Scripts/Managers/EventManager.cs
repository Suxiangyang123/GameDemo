using System.Collections;
using System.Collections.Generic;
using UnityEngine;
public enum EventType{
    StartChangeScene,
    FinishChangeScene,
    ShowUI,
    UIHide,
    SaveLevel,
    SetPlayerMovable,
    StartBuild,
    Build,
    CancelBuild,
    AddItem,
}
public class EventManager:Singleton<EventManager>
{
    public delegate void EventHandler(object sender, params object[] param);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
    private Dictionary<EventType, List<EventHandler>> EventDict = new();
    public void AddEvent(EventType type, EventHandler handler){
        if(EventDict.TryGetValue(type, out List<EventHandler> list)){
            if(!list.Contains(handler)){
                list.Add(handler);
            }
        }else{
            list = new List<EventHandler>(){handler};
            EventDict.Add(type, list);
        }
    }
    public void RemoveEvent(EventType type, EventHandler handler){
        if(EventDict.TryGetValue(type, out List<EventHandler> list)){
            list.Remove(handler);
        }
    }
    public void Invoke(EventType type, object sender, params object[] param){
        if(EventDict.TryGetValue(type, out List<EventHandler> list)){
            foreach(EventHandler handler in list){
                handler?.Invoke(sender, param);
            }
        }
    }
    public void ClearEvent(EventType type){
        if(EventDict.TryGetValue(type, out List<EventHandler> list)){
            list.Clear();
        }
    }
}
